name: Docker Build Test

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  docker-build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v3
      
    - name: Build Docker image
      run: |
        cd bot
        docker build -t pyqwerty-bot-test .
        
    - name: Test container startup
      run: |
        # Test that container can run basic imports
        docker run --rm pyqwerty-bot-test python -c "
        print('Testing imports...')
        import discord
        print('âœ… discord.py imported')
        import openai  
        print('âœ… openai imported')
        from src.core.bot import PyQwertyBot
        print('âœ… Bot class imported')
        print('ðŸŽ‰ All imports successful!')
        "